\section{Résolution numérique}

Dans cette partie, nous allons expliquer comment le problème se résout
numériquement et aborder quelques considérations en rapport avec cette
résolution.

\subsection{Principe de la résolution}
La résolution peut être découpée en plusieurs partie, plus ou moins
indépendantes.

Une première considération numérique est la discrétisation spatiale du problème
: le disque sera représenté par un ensemble de position discrète selon l’axe
radial. Ces positions s’étendent de $x_{min} = \sqrt{r_{min}/r_s}$ à $x_{max} =
\sqrt{r_{max}/r_s}$, et sont séparées par un $dx$ constant, ce qui aura pour
effet une fois revenu dans le monde dimensionné d’avoir un $dr$ parabolique,
avec donc plus de points vers le bord intérieur du disque et moins vers le bord
extérieur. Comme l'instabilité commence par se développer au niveau du bord intérieur, il est favorable d'y avoir un bon échantillonnage.

\subsubsection{Courbe en S}

L’idée ici est de trouver les zones de stationnarité du système, c’est-à-dire
celles pour lesquelles la température évolue peu. Cela revient à résoudre
l’équation $Q^+ = Q^-$. En pratique, cette courbe a une forme « en S », avec
une partie arrondie correspondant au cas optiquement épais et une partie droite
correspondant au cas optiquement mince. Il y a deux points critiques : un au
point extrême de la partie arrondie, appelé premier point critique, et un au
point de jonction des deux parties, appelé second point critique.

Il faudra donc déterminer la courbe de stationnarité en chaque point du disque,
puis sortir les coordonnées des points critiques pour chacun d’entre eux ainsi
que déterminer une position initiale pour le système sur ces courbes.

Cette partie a été réalisée essentiellement par Maximilien et Michelle.

\subsubsection{Domaines de la simulation}

Le disque à un moment $t$ peut être dans l'une des trois situations suivantes.

\paragraph{Régime stationnaire} ce régime correspond au disque dans une situation telle que tout le flux de matière entrant traverse le disque pour finir par tomber dans le trou noir. Il est caractérisé par une température et une densité surfacique constantes au cours du temps. Le taux d'accrétion est alors constant et égal au taux d'accrétion à son bord extérieur. Numériquement, il se traduit par une évolution relative de $T$ et $S$ très faible entre deux pas de temps. Lorsque ce régime est atteint, on augmentera le flux de matière entrant au bord externe et ce jusqu'à ce qu'il n'y ait plus de régime stationnaire.

\paragraph{Régime en évolution stable} ce régime correspond au disque évoluant sur un temps visqueux pour la densité surfacique et un temps thermique pour la température. Dans ce régime, on pourra négliger le terme advectif du chauffage. Ce régime se situe dans la partie inférieure de la courbe en S et est caractérisé par un quasi-équilibre thermique. On aura donc $Q^+ = Q^-$. Dans un diagramme $\Sigma-T$, ce régime correspond au suivi de la partie inférieure droite de la courbe en S.
\paragraph{Régime en évolution instable} ce régime est celui de l'instabilité. Il est caractérisé par une évolution de la densité surfacique et de la température sur un même temps thermique. Dans ce régime, au moins une partie du disque se situe à une température ou une densité de surface plus élevée que les valeurs critiques. L'équilibre thermique n'y est alors pas atteint. C'est là que se situe le cœur du problème. Le disque évacue de l'énergie par rayonnement et perds beaucoup de matière par chute dans le trou noir. Chaque point proche du point critique va effectuer des cycles autour du point critique. Ces points voient d'abord leur densité augmentée jusqu'à dépasser la densité critique. Au dela, la température croît rapidement jusqu'à ce que l'advection ne soit plus négligeable et limite la température tout en diminuant la densité localement. Le point se dirige alors vers la gauche, au dessus du point critique jusqu'à retraverser la courbe en S, où le refroidissement est plus important que le chauffage. Le point retombe alors dans la partie inférieure de la courbe en S. Tant qu'il existe des points instables, ils vont se stabiliser en déstabilisant leurs voisins.

\subsubsection{Les conditions initiales}
Les relations nous permettant d'apporter des conditions satisfaisantes au système sont données par les formules de Frank, King et Raine avec $P = P_{gaz}$ et $\kappa_{ff} \gg \kappa_{e}$ \cite{F_K_R-1985}. Ces conditions en $\Sigma$ et $T$ sont suffisamment petites pour ne pas influencer le système lors de son évolution. $\dot{M}$ est pris très petit devant  le taux $\dot{M_{0}}$ imposé au système : 
\begin{equation}
	\dot{M} = 1.10^{-1 }\dot{M_{0}}
\end{equation} 

\begin{equation}
	T = 1.4 \times 10^{4} \alpha^{- \frac{1}{5}} \left[ \frac{\dot{M}}{10^{16} \mbox{g} \mbox{s}^{-1}} \right]^{\frac{3}{10}} \left[ \frac{M}{M_{sol}}\right]^{\frac{1}{4}} \left[ \frac{r}{10^{10} cm}\right]^{- \frac{3}{4}} f^{\frac{3}{10}} \mbox{K} 
\end{equation}

\begin{align}
	\Sigma = 5.2 \alpha^{- \frac{4}{5}} \left[ \frac{\dot{M}}{10^{16} \mbox{g} \mbox{s}^{-1}} \right]^{\frac{7}{10}} \left[ \frac{M}{M_{sol}}\right]^{\frac{1}{4}} \left[ \frac{r}{10^{10} cm}\right]^{- \frac{3}{4}} f^{\frac{7}{10}} \mbox{K}  \\ 
	\text{avec } f = \left[ 1 - \left( \frac{r}{3 r_{s}}\right)^{- \frac{1}{2}}\right]
\end{align}

 \begin{figure}[ht]
   \begin{minipage}[c]{.46\linewidth}
      \includegraphics[scale=0.6]{ic_T.eps}
      \caption{Evolution de T en fonction de r à t = 0}\label{fig:CI_T}
   \end{minipage} \hfill
   \begin{minipage}[c]{.46\linewidth}
      \includegraphics[scale=0.6]{ic_Sig.eps}
      \caption{Evolution de $\Sigma$ en fonction de r à t = 0}\label{fig:CI_Sig}
   \end{minipage}
\end{figure} 


Nous pouvons voir sur les figures \ref{fig:CI_T} et \ref{fig:CI_Sig} les calculs de $T$ et $\Sigma$ en fonction de $r$ à l'instant t = 0 de la simulation. \\


Cela nous permet donc, à partir de l'utilisation du trinôme du second degré explicité équation \eqref{eq:trinôme} de calculer la hauteur du disque à l'instant $t = 0$ du système. \\

Dans le cas limite où s'expriment ces formules nous pouvons également calculer le rapport $H/r$ à partir de la formule suivante : 

\begin{equation}
	\frac{H}{r} = 1.7 \times 10^{-2}\alpha^{- \frac{1}{10}} \left[ \frac{\dot{M}}{10^{16} \mbox{g} \mbox{s}^{-1}} \right]^{\frac{3}{20}} \left[ \frac{M}{M_{sol}}\right]^{- \frac{3}{8}} \left[ \frac{r}{10^{10} cm}\right]^{- \frac{1}{8}} f^{\frac{3}{5}}
\end{equation}
 
Cela nous permet de comparer cette approximation de $H$ à la résolution par trinôme pour ces approximations de $T$ et $\Sigma$ à t = 0. \\

\begin{center}
	\includegraphics[scale=0.8]{ic_h.eps}
\end{center} 

La forme de notre disque d'accrétion découlant de ces conditions initiales est réaliste compte tenu de la masse du trou noir et de son taux d'accrétion.


\subsubsection{Évolution du disque}

La simulation commence dans le régime en évolution stable et avec des paramètres tels qu'un régime stationnaire existe. Le disque va alors rapidement se stabiliser sur la courbe en S avant de converger lentement vers l'état stationnaire. Une fois l'état stationnaire atteint, le flux de matière est augmenté. On recommence alors à suivre la courbe en S jusqu'à atteindre un nouveau régime stationnaire.

Lorsque le flux de matière entrant est trop élevé, il n'existe plus de régime stationnaire mais seulement un régime en évolution instable. Les points proches des points critiques commencent alors à effectuer des cycles d'amplitude croissante jusqu'à déclencher l'instabilité. Une fois l'instabilité terminée, la densité et la température sont de nouveau assez faible pour retomber dans un régime d'évolution stable.

\subsubsection{Intégration numérique de S et T}

L'évolution du disque d'accrétion est dominé par les deux équations sur $S$ \eqref{eq:difS} et sur $T$ \eqref{eq:difT}.

Les régimes stationnaires et en évolution stable seront traités avec un schéma explicite pour la température et un schéma implicite pour la densité de surface. On a alors un temps visqueux $\tau_\nu$ \FIXME{référence à une courbe, une section?} (voir section \ref{sec::pas_de_temps}) très grand devant le temps thermique $\tau_T$. On peut donc intégrer $S$ et $T$ sur deux échelles de temps différentes et effectuer une démarche de ``step and relax'', où on intègre d'abord $S$ sur un grand temps (visqueux) avant de laisser se relaxer $T$ sur des petits temps (thermiques). Il faut à cet endroit faire attention à ce que le temps de relaxation de $T$ soit toujours plus petit que le temps visqueux. Cela revient à vérifier que le nombre d'itérations nécessaires à la stabilisation de $T$ est plus petit que $\nicefrac{\tau_\nu}{\tau_T}$. Si cette condition est violée, la simulation numérique ne traduit plus de réalité physique. 

Une méthode implicite pour $S$ est alors préconisée. En effet, celle-ci assure de converger vers la solution et est stable quelque soit le pas de temps (dans la limite des approximations données précédemment). Les détails de la méthode sont donnés dans la partie \ref{ssec:integration_S_imp}. Pour intégrer la température, il n'est pas possible d'écrire un schéma implicite. Il faudra donc utiliser un schéma explicite. En revanche, il sera possible de procéder à des simplifications pour donner une convergence plus rapide de $T$. Les détails de ces approximations sont donnés dans la partie \ref{ssec:integration_T}.

L'autre régime est instable. Les évolutions de $S$ et de $T$ se font sur des temps similaires. Dans ce régime, il n'est plus légitime de traiter séparement ces deux variables et il faut donc résoudre conjointement l'une et l'autre. Le schéma implicite n'y est pas utilisé, car il n'assure que la convergence vers une solution physique, mais pas via des états successifs physiquement acceptables. Comme la valeur de $S$ influe sur celle de $T$, cela impliquerait que l'intégration de $T$ n'est pas non plus exacte. Dans le cas du comportement chaotique de l'instabilité, il est nécessaire de limiter au maximum les erreurs numériques car celles-ci peuvent mener à un résultat final différent du résultat physiquement attendu. Le choix d'un schéma explicite est alors fait pour $T$ et $S$, les deux évoluant alors sur le plus petit temps charactéristique du système : le pas de temps thermique. Le schéma explicite est donné dans la partie \ref{ssec:integration_S_exp} pour $S$ et dans la partie \ref{ssec:integration_T} pour $T$.

\subsubsection{Détermination du pas de temps\label{sec::pas_de_temps}}
Nous allons expliciter dans cette section les choix que nous avons fait pour déterminer les différents pas de thermique $\tau_T$ et visqueux $\tau_\nu$ nécessaires aux intégrations en schéma implicite et explicite. \\


Sur la première branche (intégration en schéma implicite), ils sont déterminés au cours de la simulation avant chaque nouvelle intégration en $S$, à partir des formules suivantes : 

\begin{equation}
	\Delta \tau_\nu^{imp} = \frac{\tau_\nu}{k_{\nu}} = \frac{1}{k_{\nu}} \times \frac{r}{v}
\end{equation}

\begin{equation}
	\Delta \tau_{T}^{imp} = \frac{\tau_{T}}{k_{T}}= \frac{1}{k_{T}} \times \frac{C_{V} T}{Q^{+} - Q^{-}}
\end{equation} \\

où $k_{\nu}$ et $k_{T}$ sont des constantes que l'on à prise respectivement égales à 100 et 1000. \\


Il est nécessaire dans cette simulation de faire intervenir un pas de temps adaptatif. En effet, l'approche du point critique que l'on peut voir en figure \ref{Fig::Stable} est délicate. Le pas de temps visqueux est donc multiplier
à chaque nouvelle intégration sur $S$ par un facteur dépendant de la distance au point critique par rapport à la variable $S$. 


\begin{equation}
	\Delta^{'} \tau_{\nu}^{imp} = \alpha \Delta \tau_{\nu}^{imp}
\end{equation} \\

où $\alpha = 1 - \left( 0.99 \times \e^{- \lvert \frac{S_{crit} - S}{D_{crit}} \rvert} \right)$, avec $D_{crit}$ défini arbitrairement : $D_{}crit = 200$ \\

Le passage en shéma d'intégration explicite est soumis à deux conditions : $T \ge T_{crit}$ ou $\Sigma \ge \Sigma_{crit}$. On bascule dès lors qu'un des rayons à rempli ces conditions. $T$ et $\Sigma$ sont alors intégrés sur le même pas de temps :

\begin{equation}
\Delta \tau_{T}^{exp} = 0.01 \times \Delta \tau_{T}^{imp}
\end{equation}

\subsubsection{Considérations sur les dérivées numériques spatiales}

Dans un certain nombre d’équations interviennent plusieurs dérivées spatiales,
du premier ou second ordre. Il existe plusieurs manières de les calculer
numériquement, ayant des conséquences variées. Nous nous intéresserons à
celles-ci dans cette partie afin d’expliquer les choix effectués.

\subsubsection{Conditions aux bords}

Toujours à propos des dérivées spatiales intervenant, l’existence de bords «
numériques » au problème implique d’imposer des conditions aux bords pour ces
dernières. Ces conditions dépendent des dérivées numériques utilisées, dans
cette partie seront présentées uniquement celles intervenant pour les dérivées
effectivement utilisées, les autres seront présentées en ANNEXE CL.
%TODO: Annexe CL

\subsubsection{Calcul des autres variables}


%\subsection{Courbe en S}
%\include{courbe_s}

\subsection{Intégration numérique de S et T}\subsection{Intégration implicite de $S$}
\label{ssec:integration_S_imp}
L'intégration implicite revient à calculer $S^t$ en fonction de $S^{t+1}$, ce qui donne un système linéaire qu'il est ensuite possible d'inverser. Il est important de noter que cette méthode est plus coûteuse à chaque pas de temps qu'une méthode explicite, car elle nécessite l'inversion d'une matrice. Il faut donc vérifier que le gain de temps de calcul lié à une intégration sur un plus grand pas de temps est plus important que le surcoût lié à l'inversion du système.\FIXME{le faire …}. Dans la simulation, on vérifie systématiquement que le temps de relaxation de $T$ est plus faible que le temps visqueux.

\paragraph{Linéarisation des équations}

On souhaite intégrer $S^\star$, la densité surfacique adimensionnée. L'équation d'évolution est :
\begin{equation}
  \frac{\partial S^\star}{\partial t^\star} = \frac{1}{x^2}\frac{\partial^2}{\partial x^2}\left(\nu^\star S^\star\right)
\end{equation}
Pour alléger les notations, nous allons ommettre les étoiles dans les développements prochains. L'équation s'écrit alors en passant aux variables discrètes, au temps $t$ et à la case $1<n\leq n_\textrm{max}$
\begin{equation}
  \label{eq:S_discret_n}
  \frac{S^{t+1}_n - S^t_n}{\Delta t} = \frac{1}{x_n^2}\frac{\nu^t_{n+1}S^{t+1}_{n+1} - 2 \nu^t_nS^{t+1}_n + \nu^t_{n-1}S^{t+1}_{n-1}}{\Delta x^2}
\end{equation}
À l'intérieur du disque, la densité de matière est supposée nulle ($\nu^t_{0}S^{t+1}_{0} = 0$). Physiquement, il est en effet attendu qu'aucune orbite keplerienne circulaire ne soit stable en dessous de l'ISCO (\emph{\emph{I}nnermost \emph{S}table \emph{C}ircular \emph{O}rbit}), située en $r = 3M$. En approximation, on suppose donc que la densité de matière y est nulle.
\begin{equation}
  \label{eq:S_discret_1}
  \frac{S^{t+1}_1 - S^t_1}{\Delta t} = \frac{1}{x_1^2}\frac{\nu^t_{2}S^{t+1}_{2} - 2 \nu^t_1S^{t+1}_1}{\Delta x^2}
\end{equation}
Pour la case $n = n_\textrm{max} = N$, on a d'après \eqref{eq:nuS_n_is_null}:
\begin{equation}
  \frac{\nu^{t}_{N+1}S^{t+1}_{N+1} - \nu^{t}_NS^{t+1}_N}{\Delta x} = \dot{M}^\star_N
\end{equation}
Il faut noter que $\dot{M}^\star_N$ vaut initialement $1$. Pour simuler l'arrivée de matière par l'extérieur du disque, cette quantité est incrémentée au fur et à mesure de la simulation.
Donc l'équation \eqref{eq:S_discret_n} s'écrit en $N$:
\begin{equation}
  \label{eq:S_discret_N}
  \frac{S^{t+1}_N - S^t_N}{\Delta t} = \frac{1}{x_N^2}\frac{\Delta x - \nu^{t}_NS^{t+1}_N + \nu^{t}_{N-1}S^{t+1}_{N-1}}{\Delta x^2}
\end{equation}

\paragraph{Écriture matricielle}
On réécrit \eqref{eq:S_discret_n}, \eqref{eq:S_discret_1} et \eqref{eq:S_discret_N} pour exprimer $S^t$ en fonction de $S^{t+1}$:
\begin{equation}
  \left\lbrace\begin{array}{r l c l c l }
    S^{t}_1 = &
               & &S_1^{t+1}\left(1 + 2\frac{\Delta t}{\Delta x^2}\frac{\nu_1^t}{x_1^2}\right)
               &+& S_{2}^{t+1}\left(-\frac{\Delta t}{\Delta x^2}\frac{\nu_{2}^t}{x_1^2}\right)\\
    S^{t}_n = &S_{n-1}^{t+1}\left(-\frac{\Delta t}{\Delta x^2}\frac{\nu_{n-1}^t}{x_n^2}\right)
               &+& S_n^{t+1}\left(1 + 2\frac{\Delta t}{\Delta x^2}\frac{\nu_n^t}{x_n^2}\right)
               &+& S_{n+1}^{t+1}\left(-\frac{\Delta t}{\Delta x^2}\frac{\nu_{n+1}^t}{x_n^2}\right)\\
    S^{t}_N + \frac{\Delta t}{\Delta x x_N^2} =
               &S^{t+1}_{N-1} \left(-\frac{\Delta t}{\Delta x^2}\frac{\nu_{N-1}^t}{x_N^2}\right)
               &+& S_N^{t+1} \left(1 + \frac{\Delta t}{\Delta x^2}\frac{\nu^t_N}{x_N^2}\right)
               & &
  \end{array}\right.
\end{equation}

Pour simplifier, on notera $A_k = 1 + 2 \frac{\Delta t}{\Delta x^2}\frac{\nu_k^t}{x_k^2}$ et $\Delta = \frac{\Delta t}{\Delta x^2}$
Ce système d'équation s'écrit aussi sous forme matricielle :
\begin{equation}
  \left(S^t\middle) + 
  \middle(\begin{matrix}
    0 \\
    \\
    \\
    \vdots \\
    \\
    \\
    \\
    0 \\
    \frac{\Delta t}{\Delta x}\frac{1}{x_N^2}
  \end{matrix}\middle)
  =
  \begin{pmatrix}
A_1                            & -\Delta\frac{\nu_{2}^t}{x_1^2} &  & & & & 0\\
-\Delta \frac{\nu_{1}^t}{x_2^2} & A_2                           & -\Delta\frac{\nu_{3}^t}{x_2^2} & & & &\\
    &        & \ddots                          &  & & & &\\
    &        & -\Delta \frac{\nu_{k-1}^t}{x_k^2} & A_k    & -\Delta \frac{\nu_{k+1}^t}{x_k^2} & &\\
    &        &                                 & & \ddots                          & & \\
    & & & & -\Delta \frac{\nu_{N-2}^t}{x_{N-1}^2} & A_{N-1} & -\Delta \frac{\nu_{N}^t}{x_{N-1}^2}\\
    0 & & & & & -\Delta \frac{\nu_{N-1}^t}{x_N^2} & 1 + \Delta \frac{\nu_N^t}{x_N^2}
  \end{pmatrix} \middle(S^{t+1}\right)
\end{equation}
Qui s'écrit aussi :
\begin{equation}
  AS^{t+1} = S^t + X 
\end{equation}
$A$ est une matrice tri-diagonale qu'il est facile de résoudre en utilisant Lapack (\href{http://www.netlib.org/lapack/explore-html/d4/d62/group__double_g_tsolve.html#ga2bf93f2ddefa5e671866eb2191dc19d4}{routine DGTSV}).
\FIXME{ajouter cela comme une référence}

\subsection{Intégration explicite de $S$}

\label{ssec:integration_S_exp}
Au contraire de l'intégration implicite, l'intégration explicite permet une résolution directe d'une équation aux dérivées partielles. Il suffit de connaître les variables à un temps $t$ pour en déduire la nouvelle valeur au temps $t+1$ :
\begin{equation}
  S^{t+1} = S^t + \Delta t f(t)
\end{equation}
La solution au temps suivant est directement donnée.

\subsection{Intégration explicite de $T$}
\label{ssec:integration_T}
Il est possible d'améliorer le schéma d'intégration explicite pour la température en donnant une meilleure estimation de $f(t)$.
\begin{equation}
  \frac{\partial T}{\partial t} = \frac{Q^+ - Q^- + Q_{adv}}{C_V} = f(T, S)
\end{equation}
On peut écrire un développement limité de $f(T) = f_0 + \frac{\partial f}{\partial T}\Delta T + \frac{\partial f}{\partial S}\Delta S$
Comme on a un temps thermique très petit devant le temps visqueux $\tau_\nu \gg \tau_T$ \FIXME{ est-ce vraiment vrai ?}
, les variations de $f$ par rapport à $S$ sont très faibles devant celles par rapport à $T$. On obtient alors $f(T) = f_0 + f'_T \Delta T$. En linéarisant, on obtient finalement:
\begin{equation}
  T^{t+1} = T^t + \frac{f_0}{f'_T}\left[e^{f'_T\Delta t} - 1 \right] 
\end{equation}
On peut facilement obtenir numériquement une approximation de $f'_T$ en calculant la quantité $\frac{f(T+\delta T) - f(T)}{\delta T}$, avec $\delta T = \lambda T,\ \lambda \ll 1$. 
\FIXME{ ajouter plot qui montre qu'on a bien df/dS << df/dT}
\FIXME{ajouter plot qui montre que la courbe est suffisamment lisse, c'est-à-dire que f'T peut bien être approximé numériquement}

\subsection{Considérations sur les dérivées}
\FIXME{peut être bouger cette partie pour la cohérence ?}

\begin{equation}
    \frac{\partial u}{\partial t} + v \frac{\partial u}{\partial r} = 0
\end{equation}

\begin{align}
    \frac{\partial u_j}{\partial r} &\approx \frac{u_{j+1} - u_j}{\Delta{r}}
    \frac{\partial u_j}{\partial r} &\approx \frac{u_j - u_{j-1}}{\Delta{r}}
    \frac{\partial u_j}{\partial r} &\approx \frac{u_{j+1} - u_{j-1}}{\Delta{r}}
\end{align}

\begin{equation}
    \frac{\partial \tilde{u}}{\partial t} = - v \frac{\exp(ik\Delta{r}) - \exp(-ik\Delta{r})}{2 \Delta{r}} \tilde{u}
\end{equation}

\begin{align}
    \exp(ik\Delta{r}) &= 1 + ik\Delta{r} + \frac{i^2 k^2 \Delta{r}^2}{2}
    \exp(-ik\Delta{r}) &= 1 - ik\Delta{r} + \frac{i^2 k^2 \Delta{r}^2}{2}
\end{align}

\begin{equation}
    \frac{\partial \tilde{u}}{\partial t} = - v \frac{2ik\Delta{r}}{2\Delta{r}} \tilde{u} = - i k v \tilde{u}
\end{equation}

\begin{equation}
    \tilde{u} = \tilde{u(0)} \exp(-i k v t)
\end{equation}

En fait, nous avons tout simplement :

\begin{equation}
    \frac{\exp(ik\Delta{r}) - \exp(-ik\Delta{r})}{2 \Delta{r}} = \frac{2 i \sin(k\Delta{r})}{2 \Delta{r}} = i k \sinc(k\Delta{r})
\end{equation}

Soit :
\begin{equation}
    \frac{\partial \tilde{u}}{\partial t} = - i k v \sinc(k\Delta{r}) \tilde{u}
\end{equation}

\begin{equation}
    \tilde{u} = \tilde{u(0)} \exp(-i k v \sinc(k \Delta{r}) t)
\end{equation}

\subsection{Considérations sur les dérivées numériques}

\begin{equation}
    \frac{\partial u}{\partial t} + v \frac{\partial u}{\partial r} = 0
\end{equation}

\begin{align}
    \frac{\partial u_j}{\partial r} &\approx \frac{u_{j+1} - u_j}{\Delta{r}} \\
    \frac{\partial u_j}{\partial r} &\approx \frac{u_j - u_{j-1}}{\Delta{r}} \\
    \frac{\partial u_j}{\partial r} &\approx \frac{u_{j+1} - u_{j-1}}{2 \Delta{r}}
\end{align}

\begin{equation}
    \frac{\partial \tilde{u}}{\partial t} = - v \frac{\exp(ik\Delta{r}) - \exp(-ik\Delta{r})}{2 \Delta{r}} \tilde{u}
\end{equation}

\begin{align}
    \exp(ik\Delta{r}) &= 1 + ik\Delta{r} + \frac{i^2 k^2 \Delta{r}^2}{2}
    \exp(-ik\Delta{r}) &= 1 - ik\Delta{r} + \frac{i^2 k^2 \Delta{r}^2}{2}
\end{align}

\begin{equation}
    \frac{\partial \tilde{u}}{\partial t} = - v \frac{2ik\Delta{r}}{2\Delta{r}} \tilde{u} = - i k v \tilde{u}
\end{equation}

\begin{equation}
    \tilde{u} = \tilde{u(0)} \exp(-i k v t)
\end{equation}

En fait, nous avons tout simplement :

\begin{equation}
    \frac{\exp(ik\Delta{r}) - \exp(-ik\Delta{r})}{2 \Delta{r}} = \frac{2 i \sin(k\Delta{r})}{2 \Delta{r}} = i k \sinc(k\Delta{r})
\end{equation}

Soit :
\begin{equation}
    \frac{\partial \tilde{u}}{\partial t} = - i k v \sinc(k\Delta{r}) \tilde{u}
\end{equation}

\begin{equation}
    \tilde{u} = \tilde{u(0)} \exp(-i k v \sinc(k \Delta{r}) t)
\end{equation}

\subsection{Conditions aux bords}

\subsection{Calcul des autres variables}

Pour chaque temps t donné, nous devons résoudre le système physique en chaque point du disque. Cela correspond à résoudre un système de 16 équations et 16 inconnus \ref{sec::eq_adim}. Nous avons vu précédemment que toutes ces quantités physiques nécessaires à  la simulation sont obtenues à  partir de formules simples et immédiates, à  l'exception de la vitesse locale d'accrétion $v$ ainsi que la demi-hauteur $H$ du disque.
\subsubsection{Résolution de la demi-hauteur $H$}
  $H$ fait en effet intervenir la résolution d'un trinôme du second degré dont nous avons détaillé le calcul ci dessous. \\

Partons de la pression P : 

\begin{equation}
	P = P_{gaz} + P_{rad}
\end{equation}


\begin{equation}
	c_{s}^{2} \rho = \frac{R \rho T}{\mu} + \frac{1}{3} a T^{4}
\end{equation}


\begin{equation}
	\Omega^{2} H^{2} \rho = \frac{R T}{\mu} \rho + \frac{1}{3} a T^{4}
\end{equation}


\begin{equation}
	\frac{1}{2} \Omega^{2} \Sigma H = \frac{R T}{\mu} \frac{\Sigma}{2 H} + \frac{1}{3} a T^{4}
\end{equation}

H est donc solution d'un trinôme du second degré $ a H^{2} + b H + c = 0$. \\
Compte tenu de l'adimensionnement considéré dans cette simulation, nous l'exprimons sous la forme suivante :  

\begin{eqnarray}
  a^{\prime} H^{* 2}+b^{\prime}H^{*}+c^{\prime}=0
  \end{eqnarray}

$\begin{cases}  
      a^{\prime} &= \Omega^{*2} \Omega_{0}^{2} S^{*} S_{0}\\
      b^{\prime} &= - \frac{2 a}{3 r_{s}} T^{*4} T_{0}^{4} x \\
      c^{\prime}&=-\frac{RT_{0}}{\mu r_{s}^{2}} T^{*} S^{*} S_{0}
     \end{cases}$ \\


\begin{equation}
	\Delta^{\prime} = b^{\prime 2} - 4a^{\prime}c^{\prime}
\end{equation} 

Il vient donc : 

\begin{equation}
	H^{*} = \frac{-b -sign(b) \sqrt{\Delta}}{2a}
\end{equation}


\subsubsection{Résolution de la vitesse locale d'accrétion $v$}
\begin{equation}
    v^\star = - \frac{1}{S^\star x} \frac{\partial}{\partial x} \left(\nu^\star S^\star\right)
\end{equation} 

Nous avons privilégié pour cette équation le calcul d'une moyenne des dérivées amonts et avales. La question de savoir lesquelles des dérivées (amonts ou avales) conduisent à  des solutions stables n'est pas nécessaire ici puisque en effet il ne s'agit pas d'une équation d'advection mais seulement d'une dérivée spatiale. Ci-dessous l'équation de la dérivée selon cette approximation : 

\begin{equation}
v^\star_{i} = - \frac{1}{S_{i}^\star x_{i}} \frac{( (\nu^{*}S^{*})_{i+1} - (\nu^{*}S^{*})_{i-1} )}{2 \Delta x_{i}}
\end{equation} 

Par contre ce choix de dérivée impose que nous mettions des conditions à  chaque bords du disque. La condition au bord intérieur est  $(\nu^{*}S^{*})_{0} = 0$, tandis que celle au bord extérieur est $v^\star_{max}   = - \dot{M^{*}}_{max} / (S^{*}x^{*})_{max}$.


\subsubsection{Ordre de résolution des équations}

Nous avons donc maintenant toutes les équations  nécessaires à  la résolution du système. L'ordre de résolution des équations est le suivant :  \\

 $\rightarrow$ Une foi le calcul de $H^{*}$ effectué, nous pouvons calculer les valeurs de la vitesse du son $cs^{*}$, de la viscosité $\nu^{*}$ ainsi que de la densité $\rho^{*}$ grâce aux formules décrites précédemment.   

 $\rightarrow$ Le calcul de $v$ nous permet quand à lui de trouver $\dot{M}$. Nous calculons également les valeurs de $\epsilon$,  $\kappa_{ff}$ et $\tau$, qui servent ensuite dans le calcul de $Fz$.
 
 $\rightarrow$ Enfin nous résolvons les équations des pressions $P_{gaz}$ et $P_{rad}$, de $\beta$,  de la capacité $Cv$ ainsi que des termes du transfert thermique $Q^{+}$, $Q^{-}$ et $Q_{adv}$.



%%% Local Variables:
%%% mode: latex
%%% TeX-master: "rapport"
%%% End: