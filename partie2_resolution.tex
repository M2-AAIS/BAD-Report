\section{Résolution numérique}

\subsection{Principe de la résolution}

\subsection{Courbe en S}
%\include{courbe_s}

\subsection{Considérations sur les dérivées}

\begin{equation}
    \frac{\partial u}{\partial t} + v \frac{\partial u}{\partial r} = 0
\end{equation}

\begin{align}
    \frac{\partial u_j}{\partial r} &\approx \frac{u_{j+1} - u_j}{\Delta{r}}
    \frac{\partial u_j}{\partial r} &\approx \frac{u_j - u_{j-1}}{\Delta{r}}
    \frac{\partial u_j}{\partial r} &\approx \frac{u_{j+1} - u_{j-1}}{\Delta{r}}
\end{align}

\begin{equation}
    \frac{\partial \tilde{u}}{\partial t} = - v \frac{\exp(ik\Delta{r}) - \exp(-ik\Delta{r})}{2 \Delta{r}} \tilde{u}
\end{equation}

\begin{align}
    \exp(ik\Delta{r}) &= 1 + ik\Delta{r} + \frac{i^2 k^2 \Delta{r}^2}{2}
    \exp(-ik\Delta{r}) &= 1 - ik\Delta{r} + \frac{i^2 k^2 \Delta{r}^2}{2}
\end{align}

\begin{equation}
    \frac{\partial \tilde{u}}{\partial t} = - v \frac{2ik\Delta{r}}{2\Delta{r}} \tilde{u} = - i k v \tilde{u}
\end{equation}

\begin{equation}
    \tilde{u} = \tilde{u(0)} \exp(-i k v t)
\end{equation}

En fait, nous avons tout simplement :

\begin{equation}
    \frac{\exp(ik\Delta{r}) - \exp(-ik\Delta{r})}{2 \Delta{r}} = \frac{2 i \sin(k\Delta{r})}{2 \Delta{r}} = i k \sinc(k\Delta{r})
\end{equation}

Soit :
\begin{equation}
    \frac{\partial \tilde{u}}{\partial t} = - i k v \sinc(k\Delta{r}) \tilde{u}
\end{equation}

\begin{equation}
    \tilde{u} = \tilde{u(0)} \exp(-i k v \sinc(k \Delta{r}) t)
\end{equation}

\section{Schéma implicite}
\subsection{Intégration de $S$}
\label{subsec:S_integration}
\subsubsection{Linéarisation des équations}
On souhaite intégrer $S^\star$, la densité surfacique adimensionnée. L'équation d'évolution est :
\begin{equation}
  \frac{\partial S^\star}{\partial t^\star} = \frac{1}{x^2}\frac{\partial^2}{\partial x^2}\left(\nu^\star S^\star\right)
\end{equation}
Pour alléger les notations, nous allons ommettre les étoiles dans les développements prochains. L'équation s'écrit alors en passant aux variables discrètes, au temps $t$ et à la case $1<n<n_\textrm{max}$
\begin{equation}
  \label{eq:S_discret_n}
  \frac{S^{t+1}_n - S^t_n}{\Delta t} = \frac{1}{x_n^2}\frac{\nu^t_{n+1}S^{t+1}_{n+1} - 2 \nu^t_nS^{t+1}_n + \nu^t_{n-1}S^{t+1}_{n-1}}{\Delta x^2}
\end{equation}
Pour la case $n = 1$, la quantité $\nu^t_{0}S^{t+1}_{0}$ est supposée nulle et donc: 
\begin{equation}
  \label{eq:S_discret_1}
  \frac{S^{t+1}_1 - S^t_1}{\Delta t} = \frac{1}{x_1^2}\frac{\nu^t_{2}S^{t+1}_{2} - 2 \nu^t_1S^{t+1}_1}{\Delta x^2}
\end{equation}
Pour la case $n = n_\textrm{max} = N$, on a d'après \eqref{eq:nuS_n_is_null}:
\begin{equation}
  \frac{\nu^{t}_{N+1}S^{t+1}_{N+1} - \nu^{t}_NS^{t+1}_N}{\Delta x} = 1
\end{equation}
et donc l'équation \eqref{eq:S_discret_n} s'écrit en $N$:
\begin{equation}
  \label{eq:S_discret_N}
  \frac{S^{t+1}_N - S^t_N}{\Delta t} = \frac{1}{x_N^2}\frac{\Delta x - \nu^{t}_NS^{t+1}_N + \nu^{t}_{N-1}S^{t+1}_{N-1}}{\Delta x^2}
\end{equation}

\subsubsection{Écriture matricielle}
On réécrit \eqref{eq:S_discret_n}, \eqref{eq:S_discret_1} et \eqref{eq:S_discret_N} pour exprimer $S^t$ en fonction de $S^{t+1}$:
\begin{equation}
  \left\lbrace\begin{array}{r l c l c l }
    S^{t}_1 = &
               & &S_1^{t+1}\left(1 + 2\frac{\Delta t}{\Delta x^2}\frac{\nu_1^t}{x_1^2}\right)
               &+& S_{2}^{t+1}\left(-\frac{\Delta t}{\Delta x^2}\frac{\nu_{2}^t}{x_1^2}\right)\\
    S^{t}_n = &S_{n-1}^{t+1}\left(-\frac{\Delta t}{\Delta x^2}\frac{\nu_{n-1}^t}{x_n^2}\right)
               &+& S_n^{t+1}\left(1 + 2\frac{\Delta t}{\Delta x^2}\frac{\nu_n^t}{x_n^2}\right)
               &+& S_{n+1}^{t+1}\left(-\frac{\Delta t}{\Delta x^2}\frac{\nu_{n+1}^t}{x_n^2}\right)\\
    S^{t}_N + \frac{\Delta t}{\Delta x x_N^2} =
               &S^{t+1}_{N-1} \left(-\frac{\Delta t}{\Delta x^2}\frac{\nu_{N-1}^t}{x_N^2}\right)
               &+& S_N^{t+1} \left(1 + \frac{\Delta t}{\Delta x^2}\frac{\nu^t_N}{x_N^2}\right)
               & &
  \end{array}\right.
\end{equation}

Pour simplifier, on notera $A_k = 1 + 2 \frac{\Delta t}{\Delta x^2}\frac{\nu_k^t}{x_k^2}$ et $\Delta = \frac{\Delta t}{\Delta x^2}$
Ce système d'équation s'écrit aussi sous forme matricielle :
\begin{equation}
  \left(S^t\middle) + 
  \middle(\begin{matrix}
    0 \\
    \\
    \\
    \vdots \\
    \\
    \\
    \\
    0 \\
    \frac{\Delta t}{\Delta x}\frac{1}{x_N^2}
  \end{matrix}\middle)
  =
  \begin{pmatrix}
A_1                            & -\Delta\frac{\nu_{2}^t}{x_1^2} &  & & & & 0\\
-\Delta \frac{\nu_{1}^t}{x_2^2} & A_2                           & -\Delta\frac{\nu_{3}^t}{x_2^2} & & & &\\
    &        & \ddots                          &  & & & &\\
    &        & -\Delta \frac{\nu_{k-1}^t}{x_k^2} & A_k    & -\Delta \frac{\nu_{k+1}^t}{x_k^2} & &\\
    &        &                                 & & \ddots                          & & \\
    & & & & -\Delta \frac{\nu_{N-2}^t}{x_{N-1}^2} & A_{N-1} & -\Delta \frac{\nu_{N}^t}{x_{N-1}^2}\\
    0 & & & & & -\Delta \frac{\nu_{N-1}^t}{x_N^2} & 1 + \Delta \frac{\nu_N^t}{x_N^2}
  \end{pmatrix} \middle(S^{t+1}\right)
\end{equation}
Qui s'écrit aussi :
\begin{equation}
  AS^{t+1} = S^t + X 
\end{equation}
$A$ est une matrice tri-diagonale qu'il est facile de résoudre en utilisant Lapack (\href{http://www.netlib.org/lapack/explore-html/d4/d62/group__double_g_tsolve.html#ga2bf93f2ddefa5e671866eb2191dc19d4}{routine DGTSV}).

\subsection{Intégration de $T$}
\label{subsec:integration_T}

Si on est dans le cas optiquement mince (ou bien négligeons terme advection ??), $T$ est régit par l'équation :
\begin{equation}
  C_v^\star \frac{\partial T^\star}{\partial t^\star} = 3v_0^2\nu^\star \Omega^\star{}^2 - \frac{F_z^\star x}{S^\star}
\end{equation}

\subsubsection{Linéarisation}
On va écrire l'équation linéarisée pour $T$. Une fois encore, nous allons ommettre les ${}^\star$ pour alléger les notations.

On note $f(T, S) = \frac{\partial T}{\partial t}(T, S)$ et $f_1(T, S) = \frac{\partial f}{\partial T}$
\begin{equation}
  \label{eq:T_devpmt_lin_2e_ordre} 
  \frac{T(t+\Delta t) - T(t)}{\Delta t} = f(T(t), S(t)) + \Delta Tf_1 + \Delta S\frac{\partial f}{\partial S}
\end{equation}
Comme $\tau_\textrm{therm} \ll \tau_\textrm{dyn}$, on va pouvoir négliger $\frac{\Delta S}{\tau_\textrm{therm}}$ devant $\frac{\Delta T}{\tau_\textrm{therm}}$. L'équation \eqref{eq:T_devpmt_lin_2e_ordre} s'écrit alors :
\begin{equation}
  \frac{T(t+\Delta t) - T(t)}{\Delta t} = f(T, S) + \Delta T f_1 = f(T, S) + \Delta t \underbrace{\frac{\Delta T}{\Delta t}}_{f} f_1
\end{equation}
Finalement, on obtient avec les écritures discrètes:
\begin{equation}
  T^{t+1}_n = T^{t}_n + \Delta t f^t_n \left(1 + \Delta t {f_1^t}_n\right)
\end{equation}

\subsubsection{Approximation de $f_1$}
Pour approximer $f_1^t$, on utilisera :
\begin{equation}
  {f_1^t}_n = \frac{f(T_n^t+\Delta T_n^t) - f(T_n^t)}{\Delta T_n^t}, \quad \Delta T_n^t = \alpha T_n^t,\ \alpha \ll 1
\end{equation}
%%% Local Variables:
%%% mode: latex
%%% TeX-master: "rapport"
%%% End:
