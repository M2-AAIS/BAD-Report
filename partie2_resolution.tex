\section{Résolution numérique}

Dans cette partie, nous allons expliquer comment le problème se résout
numériquement et aborder quelques considérations en rapport avec cette
résolution.

\subsection{Principe de la résolution}

La résolution peut être découpée en plusieurs partie, plus ou moins
indépendantes.

Une première considération numérique est la discrétisation spatiale du problème
: le disque sera représenté par un ensemble de position discrète selon l’axe
radial. Ces positions s’étendent de $x_min = \sqrt(r_min/r_s)$ à $x_max =
\sqrt(r_max/r_s)$, et sont séparées par un $dx$ constant, ce qui aura pour
effet une fois revenu dans le monde dimensionné d’avoir un $dr$ parabolique,
avec donc plus de points vers le bord intérieur du disque et moins vers le bord
extérieur, ce qui est physiquement une bonne chose a priori.

\subsubsection{Courbe en S}

L’idée ici est de trouver les zones de stationnarité du système, c’est-à-dire
celles pour lesquelles la température évolue peu. Cela revient à résoudre
l’équation $Q^+ = Q^-$. En pratique, cette courbe a une forme « en S », avec
une partie arrondie correspondant au cas optiquement épais et une partie droite
correspondant au cas optiquement mince. Il y a deux points critiques : un au
point extrême de la partie arrondie, appelé premier point critique, et un au
point de jonction des deux parties, appelé second point critique.

Il faudra donc déterminer la courbe de stationnarité en chaque point du disque,
puis sortir les coordonnées des points critiques pour chacun d’entre eux ainsi
que déterminer une position initiale pour le système sur ces courbes.

Cette partie a été réalisée essentiellement par Maximilien et Michelle.

\subsubsection{Intégration numérique de S et T}

C’est ici que se trouve le cœur du problème. Partant d’un état initial, il faut
intégrer itérativement S et T pour suivre l’évolution du disque.

Dans un premier temps, cette évolution se fait le long de la courbe par
intégrations successives de S et T à l’aide d’un schéma explicite, le terme de
convection dans l’équation sur la température pouvant être négligé. Puis, une
fois un point doublement stationnaire atteint (S n’évolue plus non plus), une
perturbation est ajoutée pour déstabiliser le système, qui va alors dépasser le
premier point critique. À partir de ce moment-là, il faut passer à un schéma
implicite, le terme de convection ne pouvant plus être négligé.

\subsubsection{Considérations sur les dérivées numériques spatiales}

Dans un certain nombre d’équations interviennent plusieurs dérivées spatiales,
du premier ou second ordre. Il existe plusieurs manières de les calculer
numériquement, ayant des conséquences variées. Nous nous intéresserons à
celles-ci dans cette partie afin d’expliquer les choix effectués.

\subsubsection{Conditions aux bords}

Toujours à propos des dérivées spatiales intervenant, l’existence de bords «
numériques » au problème implique d’imposer des conditions aux bords pour ces
dernières. Ces conditions dépendent des dérivées numériques utilisées, dans
cette partie seront présentées uniquement celles intervenant pour les dérivées
effectivement utilisées, les autres seront présentées en ANNEXE CL.
%TODO: Annexe CL

\subsubsection{Calcul des autres variables}

\subsection{Courbe en S}
%\include{courbe_s}

\subsection{Intégration numérique de S et T}

\section{Schéma implicite}
\subsection{Intégration de $S$}
\label{subsec:S_integration}
\subsubsection{Linéarisation des équations}
On souhaite intégrer $S^\star$, la densité surfacique adimensionnée. L'équation d'évolution est :
\begin{equation}
  \frac{\partial S^\star}{\partial t^\star} = \frac{1}{x^2}\frac{\partial^2}{\partial x^2}\left(\nu^\star S^\star\right)
\end{equation}
Pour alléger les notations, nous allons ommettre les étoiles dans les développements prochains. L'équation s'écrit alors en passant aux variables discrètes, au temps $t$ et à la case $1<n<n_\textrm{max}$
\begin{equation}
  \label{eq:S_discret_n}
  \frac{S^{t+1}_n - S^t_n}{\Delta t} = \frac{1}{x_n^2}\frac{\nu^t_{n+1}S^{t+1}_{n+1} - 2 \nu^t_nS^{t+1}_n + \nu^t_{n-1}S^{t+1}_{n-1}}{\Delta x^2}
\end{equation}
Pour la case $n = 1$, la quantité $\nu^t_{0}S^{t+1}_{0}$ est supposée nulle et donc: 
\begin{equation}
  \label{eq:S_discret_1}
  \frac{S^{t+1}_1 - S^t_1}{\Delta t} = \frac{1}{x_1^2}\frac{\nu^t_{2}S^{t+1}_{2} - 2 \nu^t_1S^{t+1}_1}{\Delta x^2}
\end{equation}
Pour la case $n = n_\textrm{max} = N$, on a d'après \eqref{eq:nuS_n_is_null}:
\begin{equation}
  \frac{\nu^{t}_{N+1}S^{t+1}_{N+1} - \nu^{t}_NS^{t+1}_N}{\Delta x} = 1
\end{equation}
et donc l'équation \eqref{eq:S_discret_n} s'écrit en $N$:
\begin{equation}
  \label{eq:S_discret_N}
  \frac{S^{t+1}_N - S^t_N}{\Delta t} = \frac{1}{x_N^2}\frac{\Delta x - \nu^{t}_NS^{t+1}_N + \nu^{t}_{N-1}S^{t+1}_{N-1}}{\Delta x^2}
\end{equation}

\subsubsection{Écriture matricielle}
On réécrit \eqref{eq:S_discret_n}, \eqref{eq:S_discret_1} et \eqref{eq:S_discret_N} pour exprimer $S^t$ en fonction de $S^{t+1}$:
\begin{equation}
  \left\lbrace\begin{array}{r l c l c l }
    S^{t}_1 = &
               & &S_1^{t+1}\left(1 + 2\frac{\Delta t}{\Delta x^2}\frac{\nu_1^t}{x_1^2}\right)
               &+& S_{2}^{t+1}\left(-\frac{\Delta t}{\Delta x^2}\frac{\nu_{2}^t}{x_1^2}\right)\\
    S^{t}_n = &S_{n-1}^{t+1}\left(-\frac{\Delta t}{\Delta x^2}\frac{\nu_{n-1}^t}{x_n^2}\right)
               &+& S_n^{t+1}\left(1 + 2\frac{\Delta t}{\Delta x^2}\frac{\nu_n^t}{x_n^2}\right)
               &+& S_{n+1}^{t+1}\left(-\frac{\Delta t}{\Delta x^2}\frac{\nu_{n+1}^t}{x_n^2}\right)\\
    S^{t}_N + \frac{\Delta t}{\Delta x x_N^2} =
               &S^{t+1}_{N-1} \left(-\frac{\Delta t}{\Delta x^2}\frac{\nu_{N-1}^t}{x_N^2}\right)
               &+& S_N^{t+1} \left(1 + \frac{\Delta t}{\Delta x^2}\frac{\nu^t_N}{x_N^2}\right)
               & &
  \end{array}\right.
\end{equation}

Pour simplifier, on notera $A_k = 1 + 2 \frac{\Delta t}{\Delta x^2}\frac{\nu_k^t}{x_k^2}$ et $\Delta = \frac{\Delta t}{\Delta x^2}$
Ce système d'équation s'écrit aussi sous forme matricielle :
\begin{equation}
  \left(S^t\middle) + 
  \middle(\begin{matrix}
    0 \\
    \\
    \\
    \vdots \\
    \\
    \\
    \\
    0 \\
    \frac{\Delta t}{\Delta x}\frac{1}{x_N^2}
  \end{matrix}\middle)
  =
  \begin{pmatrix}
A_1                            & -\Delta\frac{\nu_{2}^t}{x_1^2} &  & & & & 0\\
-\Delta \frac{\nu_{1}^t}{x_2^2} & A_2                           & -\Delta\frac{\nu_{3}^t}{x_2^2} & & & &\\
    &        & \ddots                          &  & & & &\\
    &        & -\Delta \frac{\nu_{k-1}^t}{x_k^2} & A_k    & -\Delta \frac{\nu_{k+1}^t}{x_k^2} & &\\
    &        &                                 & & \ddots                          & & \\
    & & & & -\Delta \frac{\nu_{N-2}^t}{x_{N-1}^2} & A_{N-1} & -\Delta \frac{\nu_{N}^t}{x_{N-1}^2}\\
    0 & & & & & -\Delta \frac{\nu_{N-1}^t}{x_N^2} & 1 + \Delta \frac{\nu_N^t}{x_N^2}
  \end{pmatrix} \middle(S^{t+1}\right)
\end{equation}
Qui s'écrit aussi :
\begin{equation}
  AS^{t+1} = S^t + X 
\end{equation}
$A$ est une matrice tri-diagonale qu'il est facile de résoudre en utilisant Lapack (\href{http://www.netlib.org/lapack/explore-html/d4/d62/group__double_g_tsolve.html#ga2bf93f2ddefa5e671866eb2191dc19d4}{routine DGTSV}).

\subsection{Intégration de $T$}
\label{subsec:integration_T}

Si on est dans le cas optiquement mince (ou bien négligeons terme advection ??), $T$ est régit par l'équation :
\begin{equation}
  C_v^\star \frac{\partial T^\star}{\partial t^\star} = 3v_0^2\nu^\star \Omega^\star{}^2 - \frac{F_z^\star x}{S^\star}
\end{equation}

\subsubsection{Linéarisation}
On va écrire l'équation linéarisée pour $T$. Une fois encore, nous allons ommettre les ${}^\star$ pour alléger les notations.

On note $f(T, S) = \frac{\partial T}{\partial t}(T, S)$ et $f_1(T, S) = \frac{\partial f}{\partial T}$
\begin{equation}
  \label{eq:T_devpmt_lin_2e_ordre} 
  \frac{T(t+\Delta t) - T(t)}{\Delta t} = f(T(t), S(t)) + \Delta Tf_1 + \Delta S\frac{\partial f}{\partial S}
\end{equation}
Comme $\tau_\textrm{therm} \ll \tau_\textrm{dyn}$, on va pouvoir négliger $\frac{\Delta S}{\tau_\textrm{therm}}$ devant $\frac{\Delta T}{\tau_\textrm{therm}}$. L'équation \eqref{eq:T_devpmt_lin_2e_ordre} s'écrit alors :
\begin{equation}
  \frac{T(t+\Delta t) - T(t)}{\Delta t} = f(T, S) + \Delta T f_1 = f(T, S) + \Delta t \underbrace{\frac{\Delta T}{\Delta t}}_{f} f_1
\end{equation}
Finalement, on obtient avec les écritures discrètes:
\begin{equation}
  T^{t+1}_n = T^{t}_n + \Delta t f^t_n \left(1 + \Delta t {f_1^t}_n\right)
\end{equation}

\subsubsection{Approximation de $f_1$}
Pour approximer $f_1^t$, on utilisera :
\begin{equation}
  {f_1^t}_n = \frac{f(T_n^t+\Delta T_n^t) - f(T_n^t)}{\Delta T_n^t}, \quad \Delta T_n^t = \alpha T_n^t,\ \alpha \ll 1
\end{equation}

\subsection{Considérations sur les dérivées numériques}

\begin{equation}
    \frac{\partial u}{\partial t} + v \frac{\partial u}{\partial r} = 0
\end{equation}

\begin{align}
    \frac{\partial u_j}{\partial r} &\approx \frac{u_{j+1} - u_j}{\Delta{r}} \\
    \frac{\partial u_j}{\partial r} &\approx \frac{u_j - u_{j-1}}{\Delta{r}} \\
    \frac{\partial u_j}{\partial r} &\approx \frac{u_{j+1} - u_{j-1}}{2 \Delta{r}}
\end{align}

\begin{equation}
    \frac{\partial \tilde{u}}{\partial t} = - v \frac{\exp(ik\Delta{r}) - \exp(-ik\Delta{r})}{2 \Delta{r}} \tilde{u}
\end{equation}

\begin{align}
    \exp(ik\Delta{r}) &= 1 + ik\Delta{r} + \frac{i^2 k^2 \Delta{r}^2}{2}
    \exp(-ik\Delta{r}) &= 1 - ik\Delta{r} + \frac{i^2 k^2 \Delta{r}^2}{2}
\end{align}

\begin{equation}
    \frac{\partial \tilde{u}}{\partial t} = - v \frac{2ik\Delta{r}}{2\Delta{r}} \tilde{u} = - i k v \tilde{u}
\end{equation}

\begin{equation}
    \tilde{u} = \tilde{u(0)} \exp(-i k v t)
\end{equation}

En fait, nous avons tout simplement :

\begin{equation}
    \frac{\exp(ik\Delta{r}) - \exp(-ik\Delta{r})}{2 \Delta{r}} = \frac{2 i \sin(k\Delta{r})}{2 \Delta{r}} = i k \sinc(k\Delta{r})
\end{equation}

Soit :
\begin{equation}
    \frac{\partial \tilde{u}}{\partial t} = - i k v \sinc(k\Delta{r}) \tilde{u}
\end{equation}

\begin{equation}
    \tilde{u} = \tilde{u(0)} \exp(-i k v \sinc(k \Delta{r}) t)
\end{equation}

\subsection{Conditions aux bords}

\subsection{Calcul des autres variables}
